<Window x:Class="SystemOptimizer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SystemOptimizer"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:controls="clr-namespace:ModernWpf.Controls;assembly=ModernWpf.Controls"
        ui:WindowHelper.UseModernWindowStyle="True"
        mc:Ignorable="d"
        Title="Effinitum X" Height="720" Width="1024"
        WindowStartupLocation="CenterScreen"
        Icon="Resources/AppIcon.ico">
    <Window.Resources>
        <Style x:Key="MenuButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Top Menu -->
        <Menu Grid.Row="0">
            <MenuItem Header="File">
                <MenuItem Header="Exit" Click="MenuExit_Click"/>
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Settings" Click="MenuSettings_Click"/>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="About" Click="MenuAbout_Click"/>
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Navigation Panel -->
            <Border Grid.Column="0" Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" BorderThickness="0,0,1,0" BorderBrush="{DynamicResource SystemControlBackgroundListMediumBrush}">
                <StackPanel Margin="5,10">
                    <Image Source="Resources/logo.png" Width="64" Height="64" Margin="0,10,0,20" HorizontalAlignment="Left"/>
                    
                    <TextBlock Text="EFFINITUM X" Margin="10,5" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                    <TextBlock Text="By Nicet ink" Margin="10,0,10,15" FontSize="11" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                    
                    <TextBlock Text="SYSTEM TOOLS" Margin="10,5" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                    
                    <Button x:Name="btnSystemInfo" Content="System Information" Style="{StaticResource MenuButtonStyle}" Click="btnSystemInfo_Click"/>
                    
                    <Button x:Name="btnCleaner" Content="System Cleanup" Style="{StaticResource MenuButtonStyle}" Click="btnCleaner_Click"/>
                    
                    <Button x:Name="btnDiskAnalyzer" Content="Disk Analyzer" Style="{StaticResource MenuButtonStyle}" Click="btnDiskAnalyzer_Click"/>
                    
                    <Button x:Name="btnProcesses" Content="Process Manager" Style="{StaticResource MenuButtonStyle}" Click="btnProcesses_Click"/>
                    
                    <Button x:Name="btnStartup" Content="Startup Manager" Style="{StaticResource MenuButtonStyle}" Click="btnStartup_Click"/>
                    
                    <Button x:Name="btnWindowsTools" Content="Windows Tools" Style="{StaticResource MenuButtonStyle}" Click="btnWindowsTools_Click"/>
                    
                    <Button x:Name="btnUwpManager" Content="UWP Apps Manager" Style="{StaticResource MenuButtonStyle}" Click="btnUwpManager_Click"/>
                    
                    <Button x:Name="btnNetworkTools" Content="Network Tools" Style="{StaticResource MenuButtonStyle}" Click="btnNetworkTools_Click"/>
                    
                    <TextBlock Text="SETTINGS" Margin="10,20,5,5" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                    
                    <Button x:Name="btnSettings" Content="Settings" Style="{StaticResource MenuButtonStyle}" Click="MenuSettings_Click"/>
                </StackPanel>
            </Border>
            
            <!-- Main Content -->
            <Grid Grid.Column="1" Margin="20">
                <!-- Welcome Page -->
                <Grid x:Name="welcomePage">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Image Source="Resources/logo.png" Width="128" Height="128" Margin="0,0,0,20"/>
                        <TextBlock Text="Effinitum X" FontSize="32" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <TextBlock Text="Welcome to Effinitum X" FontSize="24" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,20,0,0"/>
                        <TextBlock Text="Select an option from the menu to get started" FontSize="16" HorizontalAlignment="Center" Margin="0,10,0,0"/>
                        <TextBlock Text="Created by Nicet ink" FontSize="12" HorizontalAlignment="Center" Margin="0,30,0,0" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                    </StackPanel>
                </Grid>
                
                <!-- System Information Page -->
                <Grid x:Name="systemInfoPage" Visibility="Collapsed">
                    <ScrollViewer>
                        <StackPanel>
                            <TextBlock Text="System Information" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                            
                            <Expander Header="Operating System" IsExpanded="True" Margin="0,0,0,10">
                                <ListView x:Name="lvSystemInfo" BorderThickness="0">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Key}" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="1" Text="{Binding Value}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Expander>
                            
                            <Expander Header="Memory Usage" IsExpanded="True" Margin="0,0,0,10">
                                <StackPanel Margin="10">
                                    <ProgressBar x:Name="pbMemory" Height="20" Maximum="100" Value="50" Margin="0,10"/>
                                    <TextBlock x:Name="tbMemoryUsage" Text="Used: 8 GB of 16 GB (50%)" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Expander>
                            
                            <Expander Header="Disk Information" IsExpanded="True" Margin="0,0,0,10">
                                <ListView x:Name="lvDiskInfo" BorderThickness="0">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="200"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="{Binding Key}" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="1" Text="{Binding Value}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Expander>
                            
                            <Button Content="Refresh" HorizontalAlignment="Left" Click="RefreshSystemInfo_Click" Margin="0,10,0,0"/>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
                
                <!-- System Cleanup Page -->
                <Grid x:Name="cleanerPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="System Cleanup" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <ui:SimpleStackPanel Spacing="10">
                            <CheckBox x:Name="cbTempFiles" Content="Temporary Files" IsChecked="True"/>
                            <CheckBox x:Name="cbRecycleBin" Content="Recycle Bin" IsChecked="True"/>
                            <CheckBox x:Name="cbBrowserCache" Content="Browser Cache" IsChecked="True"/>
                            <CheckBox x:Name="cbWindowsLogs" Content="Windows Logs" IsChecked="True"/>
                            <CheckBox x:Name="cbWindowsUpdate" Content="Windows Update Cache" IsChecked="True"/>
                            
                            <Button x:Name="btnStartCleaning" Content="Start Cleanup" 
                                    HorizontalAlignment="Left" Margin="0,15,0,0" 
                                    Click="btnStartCleaning_Click" Padding="20,5"/>
                                    
                            <ui:ProgressRing x:Name="cleanupProgress" Visibility="Collapsed" IsActive="False" Width="25" Height="25" Margin="0,10,0,0"/>
                        </ui:SimpleStackPanel>
                        
                        <Border BorderThickness="0,1,0,0" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,20,0,15" />
                        
                        <StackPanel>
                            <TextBlock Text="Cleanup Results" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,10"/>
                            <TextBlock x:Name="tbCleaningResult" Text="Click 'Start Cleanup' to optimize your system" TextWrapping="Wrap"/>
                        </StackPanel>
                        
                        <Border BorderThickness="0,1,0,0" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,20,0,15" />
                        
                        <Expander Header="Disk Optimization" IsExpanded="True">
                            <StackPanel Margin="10">
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    Автоматическая оптимизация диска включает проверку на ошибки,
                                    дефрагментацию (для HDD) или оптимизацию TRIM (для SSD),
                                    а также очистку системных файлов и анализ для освобождения места.
                                </TextBlock>
                                
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                    <ComboBox x:Name="cbDiskOptimizeDrives" Width="150" DisplayMemberPath="Key">
                                        <ComboBox.Resources>
                                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                                <Setter Property="ui:ControlHelper.PlaceholderText" Value="Выберите диск"/>
                                            </Style>
                                        </ComboBox.Resources>
                                    </ComboBox>
                                    <controls:ToggleSwitch x:Name="tsDiskOptimizeEnabled" 
                                                  Header="Автоматическая оптимизация"
                                                  OnContent="Включена" OffContent="Отключена"
                                                  IsOn="{Binding Path=EnableDiskOptimization}"
                                                  Toggled="tsDiskOptimizeEnabled_Toggled"/>
                                </ui:SimpleStackPanel>
                                
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0">
                                    <ComboBox x:Name="cbDiskOptimizeFrequency" Width="150" SelectedIndex="2">
                                        <ComboBoxItem Content="Ежедневно"/>
                                        <ComboBoxItem Content="Еженедельно"/>
                                        <ComboBoxItem Content="Ежемесячно"/>
                                        <ComboBoxItem Content="Вручную"/>
                                    </ComboBox>
                                    <Button Content="Оптимизировать сейчас" Click="btnOptimizeDisk_Click"/>
                                </ui:SimpleStackPanel>
                                
                                <CheckBox x:Name="cbCheckDiskErrors" Content="Проверить диск на ошибки" IsChecked="True" Margin="0,10,0,0"/>
                                <CheckBox x:Name="cbDefragment" Content="Дефрагментация/TRIM" IsChecked="True" Margin="0,5,0,0"/>
                                <CheckBox x:Name="cbClearSystemFiles" Content="Очистить системные файлы" IsChecked="True" Margin="0,5,0,0"/>
                                
                                <ui:ProgressBar x:Name="pbDiskOptimize" Margin="0,10,0,0" Visibility="Collapsed"/>
                                <TextBlock x:Name="tbDiskOptimizeStatus" Text="" Margin="0,5,0,0"/>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </Grid>
                
                <!-- Disk Analyzer Page -->
                <Grid x:Name="diskAnalyzerPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Disk Analyzer" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,15">
                            <ComboBox x:Name="cbDrives" Width="200">
                                <ComboBox.Resources>
                                    <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                        <Setter Property="ui:ControlHelper.PlaceholderText" Value="Select Drive"/>
                                    </Style>
                                </ComboBox.Resources>
                            </ComboBox>
                            <Button x:Name="btnAnalyzeDisk" Content="Analyze" Click="btnAnalyzeDisk_Click"/>
                            <ui:ProgressRing x:Name="diskAnalysisProgress" Visibility="Collapsed" IsActive="False" Width="20" Height="20"/>
                        </ui:SimpleStackPanel>
                        
                        <ListView x:Name="lvFolderSize" Height="400" BorderThickness="1" 
                                  BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Path" Width="500" DisplayMemberBinding="{Binding Path}"/>
                                    <GridViewColumn Header="Size" Width="150" DisplayMemberBinding="{Binding Size}"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </StackPanel>
                </Grid>
                
                <!-- Process Manager Page -->
                <Grid x:Name="processesPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Process Manager" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,15">
                            <TextBox x:Name="tbProcessFilter" Width="300">
                                <TextBox.Resources>
                                    <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
                                        <Setter Property="ui:ControlHelper.PlaceholderText" Value="Filter processes..."/>
                                    </Style>
                                </TextBox.Resources>
                            </TextBox>
                            <Button x:Name="btnRefreshProcesses" Content="Refresh" Click="btnRefreshProcesses_Click"/>
                        </ui:SimpleStackPanel>
                        
                        <DataGrid x:Name="dgProcesses" AutoGenerateColumns="False" 
                                 IsReadOnly="True" SelectionMode="Single" Height="400" 
                                 BorderThickness="1" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="80"/>
                                <DataGridTextColumn Header="Process Name" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Memory (MB)" Binding="{Binding MemoryUsage}" Width="100"/>
                                <DataGridTextColumn Header="CPU %" Binding="{Binding CpuUsage}" Width="70"/>
                                <DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}" Width="150"/>
                                <DataGridTemplateColumn Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="End Task" 
                                                    Foreground="Red"
                                                    Command="{Binding KillProcessCommand}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Grid>
                
                <!-- UWP Apps Manager Page -->
                <Grid x:Name="uwpAppsPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="UWP Apps Manager" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,15">
                            <TextBox x:Name="tbUwpFilter" Width="300">
                                <TextBox.Resources>
                                    <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
                                        <Setter Property="ui:ControlHelper.PlaceholderText" Value="Filter apps..."/>
                                    </Style>
                                </TextBox.Resources>
                            </TextBox>
                            <Button x:Name="btnRefreshUwpApps" Content="Refresh" Click="btnRefreshUwpApps_Click"/>
                        </ui:SimpleStackPanel>
                        
                        <DataGrid x:Name="dgUwpApps" AutoGenerateColumns="False" 
                                 IsReadOnly="True" SelectionMode="Single" Height="400" 
                                 BorderThickness="1" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Publisher" Binding="{Binding Publisher}" Width="200"/>
                                <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="120"/>
                                <DataGridTextColumn Header="Size" Binding="{Binding Size}" Width="100"/>
                                <DataGridTemplateColumn Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="Uninstall" 
                                                    Foreground="Red"
                                                    Command="{Binding UninstallCommand}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <TextBlock x:Name="tbUwpStatus" Text="" Margin="0,10,0,0"/>
                    </StackPanel>
                </Grid>
                
                <!-- Windows Tools Page -->
                <Grid x:Name="windowsToolsPage" Visibility="Collapsed">
                    <ScrollViewer>
                        <StackPanel>
                            <TextBlock Text="Windows Tools" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                            
                            <Expander Header="Windows Defender" IsExpanded="True" Margin="0,0,0,15">
                                <StackPanel Margin="10">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                        Windows Defender помогает защитить ваш компьютер от вирусов и вредоносных программ, 
                                        но может потреблять системные ресурсы и замедлять работу некоторых программ.
                                    </TextBlock>
                                    
                                    <controls:ToggleSwitch x:Name="tsDefender" Header="Windows Defender" 
                                                  OnContent="Включен" OffContent="Отключен" 
                                                  Toggled="tsDefender_Toggled"/>
                                                  
                                    <Button Content="Исключить папку" Margin="0,10,0,0" Click="btnExcludeFolder_Click"/>
                                    
                                    <TextBlock x:Name="tbDefenderStatus" Text="" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                            
                            <Expander Header="Windows SmartScreen" IsExpanded="True" Margin="0,0,0,15">
                                <StackPanel Margin="10">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                        SmartScreen проверяет загружаемые файлы и запускаемые приложения на предмет безопасности, 
                                        но может замедлять запуск некоторых приложений.
                                    </TextBlock>
                                    
                                    <controls:ToggleSwitch x:Name="tsSmartScreen" Header="Windows SmartScreen" 
                                                  OnContent="Включен" OffContent="Отключен" 
                                                  Toggled="tsSmartScreen_Toggled"/>
                                                  
                                    <TextBlock x:Name="tbSmartScreenStatus" Text="" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                            
                            <Expander Header="Windows Updates" IsExpanded="True" Margin="0,0,0,15">
                                <StackPanel Margin="10">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                        Автоматические обновления Windows помогают поддерживать безопасность и 
                                        производительность системы, но могут прерывать работу и перезагружать компьютер в неудобное время.
                                    </TextBlock>
                                    
                                    <controls:ToggleSwitch x:Name="tsWindowsUpdates" Header="Автоматические обновления" 
                                                  OnContent="Включены" OffContent="Отключены" 
                                                  Toggled="tsWindowsUpdates_Toggled"/>
                                                  
                                    <ComboBox x:Name="cbUpdateFrequency" Width="200" Margin="0,10,0,0"
                                             SelectionChanged="cbUpdateFrequency_SelectionChanged">
                                        <ComboBoxItem Content="Проверять, но не загружать"/>
                                        <ComboBoxItem Content="Проверять и уведомлять"/>
                                        <ComboBoxItem Content="Полностью отключить"/>
                                    </ComboBox>
                                    
                                    <TextBlock x:Name="tbWindowsUpdatesStatus" Text="" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                            
                            <Expander Header="Microsoft Office Telemetry" IsExpanded="True" Margin="0,0,0,15">
                                <StackPanel Margin="10">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                        Microsoft Office собирает данные о производительности и использовании для улучшения продуктов, 
                                        но это может замедлять работу Office и отправлять ваши данные в Microsoft.
                                    </TextBlock>
                                    
                                    <controls:ToggleSwitch x:Name="tsOfficeTelemetry" Header="Телеметрия Office" 
                                                  OnContent="Включена" OffContent="Отключена" 
                                                  Toggled="tsOfficeTelemetry_Toggled"/>
                                                  
                                    <TextBlock x:Name="tbOfficeTelemetryStatus" Text="" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                            
                            <Expander Header="Windows Services" IsExpanded="True" Margin="0,0,0,15">
                                <StackPanel Margin="10">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                        Windows запускает множество служб в фоновом режиме, некоторые из них необязательны для работы 
                                        и могут потреблять системные ресурсы.
                                    </TextBlock>
                                    
                                    <Button Content="Оптимизировать службы Windows" Margin="0,10,0,0" Click="btnOptimizeServices_Click"/>
                                    
                                    <TextBlock x:Name="tbServicesStatus" Text="" Margin="0,10,0,0"/>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
                
                <!-- Network Tools Page -->
                <Grid x:Name="networkToolsPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Network Tools" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <Expander Header="Zapret Discord &amp; YouTube" IsExpanded="True" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    Инструмент обхода блокировок для Discord и YouTube. Использует проект zapret-discord-youtube 
                                    для восстановления доступа к заблокированным сервисам.
                                </TextBlock>
                                
                                <controls:ToggleSwitch x:Name="tsZapretEnable" Header="Обход блокировок" 
                                                      OnContent="Включен" OffContent="Отключен" 
                                                      Toggled="tsZapretEnable_Toggled"/>
                                                      
                                <CheckBox x:Name="cbZapretStartup" Content="Запускать вместе с Windows" 
                                         Margin="0,10,0,0" Checked="cbZapretStartup_Checked" Unchecked="cbZapretStartup_Unchecked"/>
                                         
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0">
                                    <Button Content="Запустить как сервис" Click="btnZapretService_Click"/>
                                    <Button Content="Перезапустить" Click="btnZapretRestart_Click"/>
                                    <Button Content="Остановить" Click="btnZapretStop_Click"/>
                                </ui:SimpleStackPanel>
                                
                                <TextBlock x:Name="tbZapretStatus" Text="" Margin="0,10,0,0"/>
                            </StackPanel>
                        </Expander>
                        
                        <Expander Header="Network Diagnostics" IsExpanded="True" Margin="0,0,0,15">
                            <StackPanel Margin="10">
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    Инструменты для диагностики и устранения проблем с сетью.
                                </TextBlock>
                                
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Margin="0,10,0,0">
                                    <Button Content="Проверить DNS" Click="btnCheckDNS_Click"/>
                                    <Button Content="Сбросить TCP/IP" Click="btnResetTcpIp_Click"/>
                                    <Button Content="Очистить DNS-кэш" Click="btnFlushDNS_Click"/>
                                </ui:SimpleStackPanel>
                                
                                <TextBox x:Name="tbNetworkDiagOutput" IsReadOnly="True" TextWrapping="Wrap"
                                       Height="150" Margin="0,10,0,0" BorderThickness="1"
                                       BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}"/>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </Grid>
                
                <!-- Startup Manager Page -->
                <Grid x:Name="startupPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Startup Manager" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <StackPanel>
                            <Button x:Name="btnLoadStartupItems" Content="Load Startup Items" 
                                    HorizontalAlignment="Left" Click="btnLoadStartupItems_Click"/>
                                    
                            <ui:ProgressRing x:Name="startupProgress" Visibility="Collapsed" IsActive="False" Width="20" Height="20" Margin="0,10"/>
                            
                            <ListView x:Name="lvStartupItems" Height="300" Margin="0,15,0,0" 
                                      BorderThickness="1" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Name" Width="200" DisplayMemberBinding="{Binding Name}"/>
                                        <GridViewColumn Header="Publisher" Width="200" DisplayMemberBinding="{Binding Publisher}"/>
                                        <GridViewColumn Header="Command" Width="300" DisplayMemberBinding="{Binding Command}"/>
                                        <GridViewColumn Header="Status" Width="100">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <controls:ToggleSwitch IsOn="{Binding IsEnabled, Mode=TwoWay}" Toggled="StartupItem_Toggled"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            
                            <Button x:Name="btnOptimizeStartup" Content="Optimize All Startup Items" 
                                    Margin="0,15,0,0" HorizontalAlignment="Left" Click="btnOptimizeStartup_Click"/>
                            
                            <TextBlock x:Name="tbStartupResult" Text="Click 'Load Startup Items' to view programs that run on system startup"
                                      Margin="0,15,0,0" TextWrapping="Wrap"/>
                                      
                            <TextBlock Text="Optimizing startup items helps speed up your system boot time by disabling unnecessary programs that run at Windows startup."
                                      TextWrapping="Wrap" Margin="0,10,0,0" Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
                
                <!-- Settings Page -->
                <Grid x:Name="settingsPage" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Settings" FontSize="24" FontWeight="SemiBold" Margin="0,0,0,20"/>
                        
                        <ui:SimpleStackPanel Spacing="15">
                            <TextBlock Text="APPEARANCE" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                            
                            <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Theme:" VerticalAlignment="Center" Width="150"/>
                                <RadioButton x:Name="rbLightTheme" Content="Light" GroupName="Theme" IsChecked="True" Checked="ThemeRadioButton_Checked"/>
                                <RadioButton x:Name="rbDarkTheme" Content="Dark" GroupName="Theme" Checked="ThemeRadioButton_Checked"/>
                                <RadioButton x:Name="rbSystemTheme" Content="Use System Setting" GroupName="Theme" Checked="ThemeRadioButton_Checked"/>
                            </ui:SimpleStackPanel>
                            
                            <Border BorderThickness="0,1,0,0" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,5"/>
                            
                            <TextBlock Text="SYSTEM OPTIMIZATION" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                            
                            <CheckBox x:Name="cbRunAtStartup" Content="Run at Windows startup"/>
                            <CheckBox x:Name="cbMinimizeToTray" Content="Minimize to system tray instead of taskbar"/>
                            <CheckBox x:Name="cbEnableNotifications" Content="Show system notifications" IsChecked="True"/>
                            
                            <Border BorderThickness="0,1,0,0" BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}" Margin="0,5"/>
                            
                            <TextBlock Text="ADVANCED" FontWeight="SemiBold" Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                            
                            <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Cleanup Aggressiveness:" VerticalAlignment="Center" Width="150"/>
                                <Slider x:Name="sliderCleanupLevel" Width="200" Minimum="1" Maximum="3" Value="2" 
                                        TickPlacement="BottomRight" TickFrequency="1" IsSnapToTickEnabled="True"/>
                                <TextBlock x:Name="tbCleanupLevel" Text="Normal" VerticalAlignment="Center"/>
                            </ui:SimpleStackPanel>
                            
                            <Button Content="Save Settings" HorizontalAlignment="Left" Margin="0,15,0,0" Click="SaveSettings_Click"/>
                        </ui:SimpleStackPanel>
                    </StackPanel>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>
