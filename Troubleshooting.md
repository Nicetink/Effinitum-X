# Устранение неполадок Effinitum X

В этом разделе описаны распространенные проблемы, возникающие при использовании Effinitum X, и способы их решения.

## Содержание
1. [Проблемы при установке](#проблемы-при-установке)
2. [Проблемы при запуске](#проблемы-при-запуске)
3. [Проблемы с интерфейсом](#проблемы-с-интерфейсом)
4. [Проблемы с функциями оптимизации](#проблемы-с-функциями-оптимизации)
5. [Проблемы с темной темой](#проблемы-с-темной-темой)
6. [Ошибки и сбои](#ошибки-и-сбои)
7. [Восстановление системы](#восстановление-системы)
8. [Чтение журналов ошибок](#чтение-журналов-ошибок)

## Проблемы при установке

### Установщик не запускается
1. Убедитесь, что файл установщика не поврежден. Попробуйте скачать его заново
2. Проверьте, не блокирует ли антивирус запуск установщика. Временно отключите антивирус
3. Проверьте настройки контроля учетных записей Windows (UAC)
4. Запустите установщик от имени администратора:
   - Щелкните правой кнопкой мыши на файле установщика
   - Выберите "Запуск от имени администратора"

### Ошибка "Приложение заблокировано из соображений безопасности"
1. Щелкните правой кнопкой мыши на файле установщика
2. Выберите "Свойства"
3. В нижней части окна свойств найдите поле "Безопасность" и отметьте "Разблокировать"
4. Нажмите "OK" и запустите установщик снова

### Ошибка "Не удается найти указанный файл" во время установки
1. Проверьте, запущен ли установщик от имени администратора
2. Выберите другую папку для установки
3. Убедитесь, что путь к папке установки не содержит специальных символов или кириллицы
4. Проверьте, достаточно ли свободного места на диске

### Установка прерывается или зависает
1. Закройте все другие программы перед установкой
2. Временно отключите антивирус и брандмауэр
3. Запустите установку в безопасном режиме Windows:
   - Перезагрузите компьютер
   - Нажмите F8 во время загрузки (или Shift+F8 в Windows 10)
   - Выберите "Безопасный режим с поддержкой сети"
   - Запустите установщик

## Проблемы при запуске

### Программа не запускается
1. Убедитесь, что установлен .NET 7.0 Runtime или новее:
   - Скачайте и установите с [официального сайта Microsoft](https://dotnet.microsoft.com/download/dotnet/7.0)
2. Запустите программу от имени администратора:
   - Щелкните правой кнопкой мыши на ярлыке программы
   - Выберите "Запуск от имени администратора"
3. Проверьте, не блокирует ли антивирус запуск программы
4. Проверьте журналы ошибок в папке программы (файлы critical_error.log и unhandled_exceptions.log)

### Ошибка "Не удается найти компонент"
1. Переустановите программу
2. Убедитесь, что все файлы программы находятся в одной папке
3. Проверьте наличие всех необходимых зависимостей:
   - .NET 7.0 Runtime
   - Visual C++ Redistributable

### Ошибка доступа или прав администратора
1. Запустите программу от имени администратора
2. Временно отключите антивирус и проверьте запуск программы
3. Проверьте настройки контроля учетных записей Windows (UAC)

### Программа запускается, но быстро закрывается
1. Запустите программу из командной строки для просмотра сообщений об ошибках:
   - Откройте командную строку (cmd) от имени администратора
   - Перейдите в папку с программой: `cd "C:\путь\к\программе"`
   - Запустите программу: `SystemOptimizer.exe`
2. Проверьте журналы ошибок в папке программы
3. Попробуйте запустить программу в режиме совместимости с предыдущей версией Windows

## Проблемы с интерфейсом

### Не отображаются элементы интерфейса
1. Проверьте настройки масштабирования Windows:
   - Правой кнопкой мыши на рабочем столе → Параметры экрана → Масштаб и разметка
   - Установите масштабирование 100%
2. Проверьте разрешение экрана. Минимальное поддерживаемое разрешение: 1024x768
3. Обновите драйверы видеокарты
4. Запустите программу в режиме совместимости с Windows 10

### Искаженные шрифты или значки
1. Проверьте, установлены ли все необходимые шрифты
2. Очистите кэш шрифтов Windows:
   - Откройте командную строку от имени администратора
   - Выполните команду: `net stop FontCache`
   - Затем: `net start FontCache`
3. Проверьте настройки DPI в свойствах программы:
   - Щелкните правой кнопкой мыши на ярлыке программы
   - Выберите "Свойства" → "Совместимость" → "Изменить параметры высокого разрешения экрана"
   - Отметьте "Переопределить поведение масштабирования, выполняемое:" и выберите "Система (расширенная)"

### Зависание интерфейса
1. Проверьте загрузку процессора и памяти во время использования программы
2. Закройте другие ресурсоемкие программы
3. Проверьте, не конфликтует ли программа с другими утилитами оптимизации
4. Обновите программу до последней версии

### Медленный отклик интерфейса
1. Отключите эффекты прозрачности в настройках программы
2. Проверьте загрузку процессора и памяти во время использования программы
3. Убедитесь, что компьютер соответствует минимальным системным требованиям
4. Оптимизируйте систему с помощью стандартных инструментов Windows

## Проблемы с функциями оптимизации

### Очистка системы не освобождает ожидаемое пространство
1. Проверьте выбранные параметры очистки
2. Убедитесь, что программа запущена с правами администратора
3. Проверьте, не заблокированы ли временные файлы другими программами
4. Закройте все браузеры перед очисткой кэша браузеров

### Ошибка "Доступ запрещен" при очистке
1. Запустите программу от имени администратора
2. Закройте программы, которые могут использовать очищаемые файлы
3. Проверьте, не заблокированы ли файлы антивирусом
4. Используйте менее агрессивный уровень очистки

### Оптимизация диска не выполняется
1. Убедитесь, что выбранный диск не используется системой или другими программами
2. Проверьте, достаточно ли свободного места на диске (минимум 15%)
3. Для дисков с файловой системой NTFS проверьте и восстановите права доступа:
   - Откройте командную строку от имени администратора
   - Выполните команду: `icacls "C:" /reset /T` (замените C: на букву нужного диска)

### Не удается оптимизировать автозагрузку
1. Убедитесь, что программа запущена с правами администратора
2. Проверьте, не защищены ли элементы автозагрузки групповой политикой (в корпоративной среде)
3. Попробуйте использовать встроенный инструмент msconfig:
   - Нажмите Win+R и введите `msconfig`
   - Перейдите на вкладку "Автозагрузка" или "Службы"

## Проблемы с темной темой

### Темная тема не применяется
1. Убедитесь, что ваша версия Windows поддерживает темную тему (Windows 10 версии 1809 или новее)
2. Проверьте настройки темы в Windows:
   - Параметры → Персонализация → Цвета → Выберите темный режим
3. Перезапустите программу после изменения настроек темы
4. Проверьте, не конфликтует ли программа с другими утилитами настройки темы

### Проблемы с прозрачностью в темной теме
1. Проверьте, включены ли эффекты прозрачности в Windows:
   - Параметры → Персонализация → Цвета → Включите "Эффекты прозрачности"
2. Убедитесь, что ваша видеокарта поддерживает эффекты прозрачности
3. Обновите драйверы видеокарты
4. Отключите прозрачность в настройках программы, если проблемы сохраняются

### Смешанные стили (светлый и темный) в интерфейсе
1. Полностью закройте программу и запустите ее заново
2. Проверьте версию Windows и обновите ее до последней версии
3. Сбросьте настройки внешнего вида программы:
   - Удалите файл конфигурации в `%AppData%\Effinitum-X\config.json`
   - Запустите программу и настройте тему заново

### Элементы интерфейса не видны в темной теме
1. Обновите программу до последней версии
2. Сбросьте настройки внешнего вида программы
3. Попробуйте использовать светлую тему вместо темной
4. Если проблема сохраняется, сообщите о ней разработчикам через [GitHub Issues](https://github.com/Nicetink/Effinitum-X/issues)

## Ошибки и сбои

### Ошибка "Необработанное исключение"
1. Проверьте журналы ошибок в папке программы (файлы critical_error.log и unhandled_exceptions.log)
2. Обновите программу до последней версии
3. Проверьте, достаточно ли прав у пользователя для выполнения операций
4. Если ошибка повторяется, сообщите о ней разработчикам, приложив журнал ошибок

### Программа перестает отвечать во время выполнения операций
1. Проверьте загрузку процессора, памяти и диска во время выполнения операций
2. Убедитесь, что компьютер соответствует минимальным системным требованиям
3. Закройте все другие программы перед выполнением ресурсоемких операций
4. Попробуйте выполнять операции по отдельности, а не все сразу

### Ошибка при запуске функции "Обход блокировок"
1. Убедитесь, что программа запущена с правами администратора
2. Проверьте соединение с интернетом
3. Временно отключите антивирус и брандмауэр
4. Проверьте, не блокируется ли функция корпоративными политиками безопасности

### Ошибка при взаимодействии с Windows Defender
1. Убедитесь, что Windows Defender установлен и активен
2. Проверьте, не управляется ли Windows Defender групповой политикой (в корпоративной среде)
3. Временно отключите другие антивирусные программы
4. Перезагрузите службу Windows Defender:
   - Откройте командную строку от имени администратора
   - Выполните команды:
     ```
     net stop WinDefend
     net start WinDefend
     ```

## Восстановление системы

### Как восстановить систему после неудачной оптимизации
1. Запустите восстановление системы:
   - Нажмите Win+R и введите `rstrui.exe`
   - Выберите точку восстановления, созданную перед оптимизацией
   - Следуйте инструкциям мастера восстановления
2. Если точка восстановления недоступна, используйте инструмент "Восстановление системы" в Effinitum X

### Как исправить повреждения реестра после оптимизации
1. Восстановите реестр из резервной копии:
   - Откройте Effinitum X
   - Перейдите в раздел "Инструменты" или "Дополнительно"
   - Выберите "Восстановить реестр из резервной копии"
2. Если резервная копия недоступна, выполните восстановление системы
3. В крайнем случае, используйте встроенную утилиту восстановления реестра:
   - Нажмите Win+R и введите `regedit`
   - Выберите меню "Файл" → "Импорт" и найдите файл резервной копии реестра

### Как вернуть настройки Windows по умолчанию
1. Откройте Effinitum X
2. Перейдите в раздел "Расширенная оптимизация"
3. Нажмите кнопку "Восстановить стандартные настройки"
4. Выберите компоненты, которые нужно восстановить
5. Нажмите "Применить" и перезагрузите компьютер

### Как исправить проблемы с Windows Update после оптимизации
1. Восстановите службу Windows Update:
   - Откройте командную строку от имени администратора
   - Выполните следующие команды:
     ```
     net stop wuauserv
     net stop bits
     del /f /s /q %windir%\SoftwareDistribution\*
     net start wuauserv
     net start bits
     ```
2. Используйте инструмент "Восстановление службы обновлений" в Effinitum X

## Чтение журналов ошибок

Effinitum X создает следующие журналы ошибок, которые могут помочь в диагностике проблем:

### critical_error.log
Содержит информацию о критических ошибках, которые приводят к аварийному завершению программы. Расположение:
- Для установленной версии: `%AppData%\Effinitum-X\logs\critical_error.log`
- Для портативной версии: `папка_программы\logs\critical_error.log`

### unhandled_exceptions.log
Содержит информацию о необработанных исключениях, которые могут возникать во время работы программы. Расположение:
- Для установленной версии: `%AppData%\Effinitum-X\logs\unhandled_exceptions.log`
- Для портативной версии: `папка_программы\logs\unhandled_exceptions.log`

### app_log.txt
Содержит общую информацию о работе программы, включая информацию о запуске, выполнении операций и закрытии. Расположение:
- Для установленной версии: `%AppData%\Effinitum-X\logs\app_log.txt`
- Для портативной версии: `папка_программы\logs\app_log.txt`

### Как использовать журналы ошибок
1. Откройте соответствующий файл журнала в текстовом редакторе
2. Найдите записи, соответствующие времени возникновения проблемы
3. Обратите внимание на сообщения об ошибках, исключениях и стек вызовов
4. При обращении в поддержку или создании issue на GitHub, приложите соответствующие части журнала

Если вы столкнулись с проблемой, которая не описана в этом руководстве, обратитесь за помощью, создав [issue](https://github.com/Nicetink/Effinitum-X/issues) на GitHub с подробным описанием проблемы, включая:
- Версию программы
- Версию операционной системы
- Шаги для воспроизведения проблемы
- Скриншоты (если возможно)
- Соответствующие части журналов ошибок 